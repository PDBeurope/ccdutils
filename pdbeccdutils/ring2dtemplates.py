import logging
from collections import OrderedDict
# noinspection PyPackageRequirements
from rdkit import Chem


ring_template_sdf = OrderedDict()
ring_template_rdkit_mol = OrderedDict()


def supply_ring_template_rdkit_mol():
    if len(ring_template_rdkit_mol) == 0:
        load_ring_template_rdkit_mol()
    return ring_template_rdkit_mol


def load_ring_template_rdkit_mol():
    load_sdf()
    for key, sdf in ring_template_sdf.items():
        rdkit_mol = Chem.MolFromMolBlock(sdf)
        logging.debug('ring template {} has {} atoms'.format(key, rdkit_mol.GetNumAtoms()))
        for bond in rdkit_mol.GetBonds():
            bond.SetBondType(Chem.rdchem.BondType.UNSPECIFIED)
        ring_template_rdkit_mol[key] = rdkit_mol


def load_sdf():
    ring_template_sdf['porphin'] = """
chemspider 10447586

 24 28  0  0000  0  0  0  0  0999 V2000
    2.0176   -2.0304    0.0000 N   0  0  0  0  0  0  0  0  0  0  0
    2.0112   -4.3683    0.0000 N   0  0  0  0  0  0  0  0  0  0  0
    4.3618   -2.0368    0.0000 N   0  0  0  0  0  0  0  0  0  0  0
    4.3490   -4.3683    0.0000 N   0  0  0  0  0  0  0  0  0  0  0
    0.6597   -2.0304    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    2.0176   -0.6853    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    0.6597   -4.3683    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    4.3618   -0.6853    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    2.0112   -5.7261    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    5.7197   -2.0368    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    4.3490   -5.7261    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    5.7133   -4.3875    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    0.0000   -3.1961    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    3.1833   -0.0064    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    3.1705   -6.4051    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    6.3794   -3.1961    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    0.0000   -0.8519    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    0.8519   -0.0064    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    0.0000   -5.5276    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    5.5276    0.0000    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    0.8519   -6.3923    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    6.3923   -0.8711    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    5.5212   -6.3923    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
    6.3794   -5.5468    0.0000 C   0  0  0  0  0  0  0  0  0  0  0
  1  5  1  0
  1  6  1  0
  2  7  1  0
  2  9  2  0
  3  8  1  0
  3 10  2  0
  4 11  1  0
  4 12  1  0
  5 13  1  0
  5 17  2  0
  6 14  1  0
  6 18  2  0
  7 13  2  0
  7 19  1  0
  8 14  2  0
  8 20  1  0
  9 15  1  0
  9 21  1  0
 10 16  1  0
 10 22  1  0
 11 15  2  0
 11 23  1  0
 12 16  2  0
 12 24  1  0
 17 18  1  0
 19 21  2  0
 20 22  2  0
 23 24  2  0
M  END

> <StdInChI>
InChI=1S/C20H14N4/c1-2-14-10-16-5-6-18(23-16)12-20-8-7-19(24-20)11-17-4-3-15(22-17)9-13(1)21-14/h1-12,21,24H/b13-9-,14-10-,15-9-,16-10-,17-11-,18-12-,19-11-,20-12-

> <StdInChIKey>
RKCAIXNGYQCCAL-CEVVSZFKSA-N

> <AuxInfo>
1/0/N:17,18,19,21,20,22,23,24,13,14,15,16,5,6,7,8,9,10,11,12,1,2,3,4/E:(1,2,7,8)(3,4,5,6)(9,10,11,12)(13,14,19,20)(15,16,17,18)(21,24)(22,23)/rA:24nNNNNCCCCCCCCCCCCCCCCCCCC/rB:;;;s1;s1;s2;s3;d2;d3;s4;s4;s5d7;s6d8;s9d11;s10d12;d5;d6s17;s7;s8;s9d19;s10d20;s11;s12d23;/rC:2.0176,-2.0304,0;2.0112,-4.3683,0;4.3618,-2.0368,0;4.349,-4.3683,0;.6597,-2.0304,0;2.0176,-.6853,0;.6597,-4.3683,0;4.3618,-.6853,0;2.0112,-5.7261,0;5.7197,-2.0368,0;4.349,-5.7261,0;5.7133,-4.3875,0;0,-3.1961,0;3.1833,-.0064,0;3.1705,-6.4051,0;6.3794,-3.1961,0;0,-.8519,0;.8519,-.0064,0;0,-5.5276,0;5.5276,0,0;.8519,-6.3923,0;6.3923,-.8711,0;5.5212,-6.3923,0;6.3794,-5.5468,0;

> <Formula>
C20 H14 N4

> <Mw>
310.352

> <SMILES>
N1C2=CC=C1C=C1C=CC(C=C3C=CC(=CC4C=CC(=C2)N=4)N3)=N1 |t:6,11,15,20|

> <CSID>
10447586

$$$$"""


